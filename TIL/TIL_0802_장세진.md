# pyserial

- python 3.x에서 설치

```bash
$ pip install pyserial
```

- 기본적으로 아두이노는 UART 방식의 Serial 통신을 지원하며, 이 통신 방식으로 컴퓨터와 통신이 가능합니다.
    - 아두이노를 파이썬이 직접 제어하는 것이 아니라, **아두이노는 컴퓨터와 통신**을 하고, **파이썬은 pyserial 모듈을 이용해서 컴퓨터(정확히는 컴퓨터의 시리얼 통신 기능)를 제어** 한다는 것입니다.
    - **아두이노 IDE로 코딩을 해서 아두이노 보드에 시리얼 통신 기능이 포함된 코드를 컴파일**
    해주고, **별도로 파이썬으로 코딩**을 해줘야 한다는 말입니다.
- python 예시 코드

```bash
import serial
import time

# serial모드의 Serial함수를 이용해 port와 badurate 설정
py_serial = serial.Serial(  
    
    # Window
    port='COM3',
    
    # 보드 레이트 (통신 속도)
    baudrate=9600,
)

# 아두이노에 내릴 명령을 input함수를 통해 입력해주고, 명령어를 serial통신을 이용해 보내주기
while True:
      
    commend = input('아두이노에게 내릴 명령:')
    
    py_serial.write(commend.encode()) # encode => 한글, 영어같은 것을 시리얼 통신에 최적화된 상태로 변형시켜주는 것
    
    time.sleep(0.1)
	
		
		# 아두이노에서 받은 시리얼 통신(명령에 대한 반응메시지)받는 부분
    
    if py_serial.readable():
        
        # 들어온 값이 있으면 값을 한 줄 읽음 (BYTE 단위로 받은 상태)
        # BYTE 단위로 받은 response 모습 : b'\xec\x97\x86\xec\x9d\x8c\r\n'
        response = py_serial.readline()
        
        # 디코딩 후, 출력 (가장 끝의 \n을 없애주기위해 슬라이싱 사용)
        print(response[:len(response)-1].decode())  # decode => 시리얼에서 한글, 영어같은 읽기 쉬운 글자로 바꿔줌
```

- 위의 파이썬 코드를 실행하면 터미널 창을 아두이노 시리얼 모니터처럼 사용 가능

- serial통신으로 받은 값 db에 저장하기

[https://scribblinganything.tistory.com/52](https://scribblinganything.tistory.com/52)

## 파이썬으로 일정한 시간마다 동작 수행하기

### 쓰레드(Thread)

- [https://docs.python.org/ko/3/library/threading.html](https://docs.python.org/ko/3/library/threading.html)
- 패키지 이름은 threading

```python
import threading
```

- 병렬식

### 스케쥴

```bash
$ pip install schedule
```

```python
import time
import schedule
 
#특정 함수 정의
def printhello():
    print("Hello!")
 
 
schedule.every(30).minutes.do(printhello) #30분마다 실행
schedule.every().monday.at("00:10").do(printhello) #월요일 00:10분에 실행
schedule.every().day.at("10:30").do(job) #매일 10시30분에 
 
#실제 실행하게 하는 코드
# 무한루프를 돌면서 스케쥴을 유지한다.
while True:
    schedule.run_pending()
    time.sleep(1)

```

- 스케쥴을 지속적으로 유지하기 위해 아래와 같이 while True 무한 루프 구문을 활용한다.
    - `schedule.run_pending()`은 무한루프를 돌면서 1초에 한번씩 스케쥴을 지속적으로 체크하는 구문이다. (이 구문이 있어야 스케쥴 코드가 실행된다.